<canvas id="gc" width="400" height="400"></canvas>

<script>

// Canvas
var gameHeight = 400;
var gameWidth = 400;
var tilesX = 8;
var tilesY = 8;
var tileWidth = gameWidth / tilesX;
var tileHeight = gameHeight / tilesY;
var rowsOfPieces = 3;

// Game attributes
var whiteTurn = true;
var selectedPiece = null;
var selectedWhite = true;

var blackPieces = [];
var blackKings = [];
var whitePieces = [];
var whiteKings = [];

window.onload=function() {
	canvas = document.getElementById("gc");
	context = canvas.getContext("2d");
	document.addEventListener("mousedown", selectPiece);
	document.addEventListener("mouseup", movePiece);
	initialiseGame();
	drawGame();
}

function initialiseGame() {
	blackPieces = [];
	blackKings = [];
	whitePieces = [];
	whiteKings = [];
	
	for (let x = 0; x < tilesX; x++){
		for (let y = 0; y < rowsOfPieces; y++){
			if (x % 2 ==  y % 2){
				let piece = [x, y];
				blackPieces.push(piece);
			}
		}
	}
	
	for (let x = 0; x < tilesX; x++){
		for (let y = tilesY - rowsOfPieces; y < tilesY; y++){
			if (x % 2 ==  y % 2){
				let piece = [x, y];
				whitePieces.push(piece);
			}
		}
	}
	
	selectedPiece = null;
	
	whiteTurn = true;
}

function selectPiece(press){
	var tileX = parseInt(press.x / tileWidth);
	var tileY = parseInt(press.y / tileHeight);
	
	selectedPiece = getPiece(tileX, tileY);
	
	console.log("selectPiece(): " + selectedPiece);
}

function getPiece(x, y){
	if (whiteTurn){
		for (let i = 0; i < whitePieces.length; i++){
			if (x == whitePieces[i][0] && y == whitePieces[i][1]){
				selectedWhite = true;
				var array = [x, y];
				console.log (array);
				return [x, y];
			}
		}
	}
	if (!whiteTurn){
		for (let i = 0; i < blackPieces.length; i++){
			if (x == blackPieces[i][0] && y == blackPieces[i][1]){
				selectedWhite = false;
				return [x, y];
			}
		}
	}
	return null;
}

function movePiece(release){
	if (selectedPiece == null) return;
	
	var tileX = parseInt(release.x / tileWidth);
	var tileY = parseInt(release.y / tileHeight);
	
	if (!(tileX % 2 == tileY %2)) return;
	
	if (selectedWhite){
		console.log("White selected");
		
		console.log("1 " + whitePieces);
		console.log("2 " + selectedPiece);
		whitePieces = removeFromArray(whitePieces, selectedPiece);
		console.log("Index of " + selectedPiece + " is: " + removeIndex);
		if (removeIndex > -1){
			whitePieces.splice(removeIndex, 1);
			console.log("Removing index");
		}
		whitePieces.push([tileX, tileY]);
	}
	
	console.log(tileX + "-" + tileY);
	
	selectedPiece = null;
	selectedWhite = !selectedWhite;
	
	console.log(whitePieces);
}

function removeFromArray(array1, array2){
	console.log("1 " + array1);
	console.log("2 " + array2);
	var array = [];
	for (let i = 0; i < array1.length; i++){
		if (!(array1[i][0] == array2[0] 
			&& array[i][1] == array2[1])){
			array.push(array1[i]);
		}
	}
	console.log(array);
	return array;
}

function validMove(originalX, originalY, destX, destY){
	return true;
}

function drawGame(){
	
	context.clearRect(0, 0, canvas.width, canvas.height);
	context.lineWidth = 0;
	
	for (let x = 0; x < tilesX; x++){
		for (let y = 0; y < tilesY; y++){
			
			colour = "BlanchedAlmond";
			
			if (x % 2 ==  y % 2){
				colour = "Tan";
			}
			
			context.fillStyle = colour;
			
			context.fillRect(
				x * tileWidth,
				y * tileHeight,
				tileWidth,
				tileHeight
			)
		}
	}
	
	colour = "White";
	context.fillStyle = colour;
	for (let i = 0; i < whitePieces.length; i++){
		var centreX = whitePieces[i][0] * tileWidth + tileWidth / 2;
		var centreY = whitePieces[i][1] * tileHeight + tileHeight / 2;
		var radius = tileHeight / 2.5;
		if (tileWidth < tileHeight){
			radius = tileWidth / 2.5;
		}
		context.beginPath();
		context.arc(centreX, centreY, radius, 0, 2 * Math.PI, false);
		context.fill();
	}
	
	colour = "Black";
	context.fillStyle = colour;
	for (let i = 0; i < blackPieces.length; i++){
		var centreX = blackPieces[i][0] * tileWidth + tileWidth / 2;
		var centreY = blackPieces[i][1] * tileHeight + tileHeight / 2;
		var radius = tileHeight / 2.5;
		if (tileWidth < tileHeight){
			radius = tileWidth / 2.5;
		}
		context.beginPath();
		context.arc(centreX, centreY, radius, 0, 2 * Math.PI, false);
		context.fill();
	}
	
	context.stroke();
}

</script>